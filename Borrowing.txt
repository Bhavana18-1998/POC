swagger: '2.0'
info:
  title: Borrowing
  x-ibm-name: borrowing
  x-ibm-summary: Manage borrowing from other agencies
  version: 0.0.1
  description: API to record and manage borrowings
schemes:
  - https
security:
  - clientID: []
securityDefinitions:
  clientID:
    type: apiKey
    in: header
    name: X-IBM-Client-Id
x-ibm-configuration:
  cors:
    enabled: true
  gateway: datapower-api-gateway
  type: rest
  phase: realized
  enforced: true
  testable: true
  assembly:
    execute:
      - invoke:
          title: Invoke IAM Introspection
          version: 2.0.0
          verb: GET
          target-url: $(authorization-url)
          follow-redirects: false
          timeout: 60
          parameter-control:
            type: blacklist
          header-control:
            type: blacklist
            values:
              - ^X-IBM-Client-Id$
          inject-proxy-headers: true
      - switch:
          version: 2.0.0
          title: switch
          case:
            - condition: ($statusCode() != 200)
              execute:
                - throw:
                    version: 2.0.0
                    title: throw
                    name: Token_Error
      - parse:
          version: 2.0.0
          title: parse
          parse-settings-reference:
            default: apic-default-parsesettings
      - gatewayscript:
          version: 2.0.0
          title: Request
          source: >
            var apim = require('apim');

            var json = apim.getvariable('request.body');

            var auth = apim.getvariable('request.headers');

            var authStr = auth.Authorization;

            var notification =
            apim.getvariable('request.headers.x-notification-url');

            var callback= apim.getvariable('request.headers.x-callback-url');


            context.message.header.set('Authorization',authStr);

            context.message.header.set('x-notification-url',notification);

            context.message.header.set('x-callback-url',callback);


            var id=apim.getvariable('request.headers.X-IBM-Client-Id');

            context.message.header.set('X-IBM-Client-Id',id);

            session.output.write(json);
      - switch:
          version: 2.0.0
          title: switch
          case:
            - condition: ($operationID() = 'createBorrowing')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Create Borrowings
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      $(bc-url)/rental-agencies/$(request.parameters.agencyDid)/borrowings
            - condition: ($operationID() = 'getBorrowingsById')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Get By Id
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      $(bc-url)/rental-agencies/$(request.parameters.agencyDid)/borrowings/$(request.parameters.did)
            - condition: ($operationID() = 'deleteBorrowing')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Delete  Borrowings
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      $(bc-url)/rental-agencies/$(request.parameters.agencyDid)/borrowings/$(request.parameters.did)
            - condition: ($operationID() = 'updateBorrowing')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Update  Borrowings
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      $(bc-url)/rental-agencies/$(request.parameters.agencyDid)/borrowings/$(request.parameters.did)
            - condition: ($operationID() = 'returnBorrowingById')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Return Borrowing
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      $(bc-url)/rental-agencies/$(request.parameters.agencyDid)/borrowings/$(request.parameters.did)/events/return
            - condition: ($operationID() = 'createBulkBorrowings')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Add Bulk borrowings
                    backend-type: detect
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    use-http-10: false
                    chunked-uploads: true
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      $(bulk-url)/bulk/agencies/$(request.parameters.agencyDid)/borrowings
            - condition: ($operationID() = 'getBulkStatusById')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Get Bulk Borrowings
                    backend-type: detect
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    use-http-10: false
                    chunked-uploads: true
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: $(bulk-url)/tasks/$(request.parameters.id)
            - condition: ($operationID() = 'getBorrowingReturnById')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Get Return By Id
                    backend-type: detect
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    use-http-10: false
                    chunked-uploads: true
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      http://tars-blockchain-ms.tars-blockchain.apps.tars.ucmcswg.com/rental-agencies/$(request.parameters.agencyDid)/borrowings/$(request.parameters.did)/returns
            - condition: ($operationID() = 'Receiveborrowing')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Receive Borrowing
                    backend-type: detect
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    use-http-10: false
                    chunked-uploads: true
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      http://tars-blockchain-ms.tars-blockchain.apps.tars.ucmcswg.com/rental-agencies/$(request.parameters.agencyDid)/borrowings/$(request.parameters.did)/events/receive
            - condition: ($operationID() = 'closeBorrowingById')
              execute:
                - invoke:
                    version: 2.0.0
                    title: Close Borrowing
                    backend-type: detect
                    header-control:
                      type: blacklist
                      values: []
                    parameter-control:
                      type: whitelist
                      values: []
                    timeout: 60
                    verb: keep
                    use-http-10: false
                    chunked-uploads: true
                    cache-response: protocol
                    cache-ttl: 900
                    stop-on-error: []
                    target-url: >-
                      $(bc-url)/rental-agencies/$(request.parameters.agencyDid)/borrowings/$(request.parameters.did)/events/close
      - switch:
          version: 2.0.0
          title: switch
          case:
            - condition: ($statusCode() = 200 or $statusCode() = 202)
              execute: []
            - otherwise:
                - gatewayscript:
                    version: 2.0.0
                    title: Map Error
                    source: |+
                      var apim = require('apim');
                      var json = apim.getvariable('message.status');

                      var code=json.code;
                      var msg=json.reason;


                      var strtoken=apim.getvariable('message.body');


                      if(strtoken)
                      {
                      var detail=strtoken.detail;
                      context.message.header.set('detail',detail);
                      }

                      context.message.header.set('httpCode',code);

                      context.message.header.set('httpMessage',msg);









                - map:
                    version: 2.0.0
                    title: map
                    inputs:
                      code:
                        schema:
                          type: string
                        variable: message.headers.httpCode
                      message:
                        schema:
                          type: string
                        variable: message.headers.httpMessage
                      details:
                        schema:
                          type: string
                        variable: message.headers.detail
                    outputs:
                      output:
                        schema:
                          $ref: '#/definitions/Error'
                        variable: message.body
                        content: application/json
                    actions:
                      - set: output.httpCode
                        from: code
                      - set: output.httpMessage
                        from: message
                      - set: output.moreInformation
                        from: details
                - set-variable:
                    version: 2.0.0
                    title: set-variable
                    actions:
                      - clear: message.headers.httpCode
                      - clear: message.headers.httpMessage
                      - clear: message.headers.detail
    catch:
      - errors:
          - Token_Error
        execute:
          - map:
              version: 2.0.0
              title: map
              inputs:
                input:
                  schema:
                    $ref: '#/definitions/Error'
                  variable: message.body
                  content: application/json
              outputs:
                output:
                  schema:
                    $ref: '#/definitions/Error'
                  variable: message.body
                  content: application/json
              actions:
                - set: output.moreInformation
                  from: input.moreInformation
                - set: output.httpCode
                  value: '''401'''
                - set: output.httpMessage
                  value: '''Unauthorized'''
          - set-variable:
              version: 2.0.0
              title: set-variable
              actions:
                - set: message.status.code
                  value: '401'
                  type: string
  properties: {}
  application-authentication:
    certificate: false
  activity-log:
    success-content: payload
    error-content: payload
    enabled: true
  buffering: true
  catalogs: {}
definitions:
  BorrowingBulkStatusResponse:
    type: object
    additionalProperties: false
  BorrowingBulkRequest:
    type: array
    items:
      $ref: '#/definitions/Borrowing'
  BorrowingArray:
    type: array
    items:
      $ref: '#/definitions/Borrowings'
  AgencyHeader:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Agency
        format: int64
        example: 1
      did:
        type: string
        description: Decentralized Identifier for the Agency
        example: 'did:ded:1210141'
      source:
        type: string
        description: Source for the Decentralized ID
        example: ded
      sourceKey:
        type: string
        description: Natural Key from the Source. e.g. Trade License Number
        example: '1210141'
      versionHash:
        type: string
        description: Hash of all trackable attributes
        example: 2fdc0177057d3a5c6c2c0821e01f4fa8d90f9a3bb7afd82b0db526af98d68de8
      name:
        $ref: '#/definitions/MultiLang'
      tradeLicenseNumber:
        type: string
        description: 'tradeLicenseNumber '
        example: '12764548'
    description: Agency
  ContractDetails:
    type: object
    properties:
      vehicle:
        $ref: '#/definitions/VehicleHeader'
      drivers:
        type: array
        description: Drivers
        items:
          $ref: '#/definitions/Driver'
      startDate:
        type: string
        description: Start Date
        format: date-time
      expectedReturnDate:
        type: string
        description: Expected Return Date
        format: date-time
      readings:
        type: array
        description: Vehicle Reading
        items:
          $ref: '#/definitions/VehicleReading'
    description: Details
  BasicAddress:
    type: object
    properties:
      address:
        $ref: '#/definitions/EnAr'
      area:
        $ref: '#/definitions/EnArCode'
      building:
        $ref: '#/definitions/EnArCode'
      city:
        $ref: '#/definitions/EnArCode'
      community:
        $ref: '#/definitions/EnArCode'
      country:
        $ref: '#/definitions/EnArCode'
      emirate:
        $ref: '#/definitions/EnArCode'
      geoLocation:
        type: object
        properties:
          longitude:
            type: number
            format: float
            description: The longitude of the address.
          latitude:
            type: number
            format: float
            description: The latitude of the address.
      label:
        type: string
        example: work
      makani:
        type: string
        description: Makani number
        example: 24330 87031
      poBox:
        type: string
        example: '9226'
      postalCode:
        type: string
        example: '9226'
      preferred:
        type: boolean
        example: true
        description: Preferred address flag
      region:
        $ref: '#/definitions/EnArCode'
      street:
        $ref: '#/definitions/EnArCode'
      subArea:
        $ref: '#/definitions/EnArCode'
      unit:
        $ref: '#/definitions/EnArCode'
  EnArCode:
    type: object
    properties:
      code:
        type: string
      name:
        $ref: '#/definitions/EnAr'
    description: >-
      Object with properties en, ar, and code.  At least one of en or ar is
      required.
  MultiLang:
    type: object
    properties:
      en:
        type: string
        description: English
        example: English
      ar:
        type: string
        description: Arabic
        example: عربي
    description: Name in Arabic and English
  VehicleHeader:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Vehicle
        format: int64
        example: 1
      did:
        type: string
        description: Decentralized Identifier for the Vehicle
        example: 'did:rta:1GNCS18Z3M0115561'
      source:
        type: string
        description: Source for the Decentralized ID
        example: rta
      sourceKey:
        type: string
        description: Natural Key from the Source
        example: 1GNCS18Z3M0115561
      versionHash:
        type: string
        description: Hash of all trackable attributes
        example: 2fdc0177057d3a5c6c2c0821e01f4fa8d90f9a3bb7afd82b0db526af98d68de8
      vin:
        type: string
        description: Vehicle Identification Number
        example: 1GNCS18Z3M0115561
      plate:
        $ref: '#/definitions/Plate'
    description: Vehicle
  Amount:
    type: object
    properties:
      currencyCode:
        type: string
        description: Currency Code
        example: AED
      value:
        type: number
        description: Value
        format: double
        example: 100
    description: Yearly Rate
  Driver:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Agency
        format: int64
        example: 1
      did:
        type: string
        description: Decentralized Identifier for the Agency
        example: 'did:rta:1021252'
      source:
        type: string
        description: Source for the Decentralized ID
        example: rta
      sourceKey:
        type: string
        description: Natural Key from the Source
        example: '1021252'
      name:
        $ref: '#/definitions/PersonNameMultiLang'
      gender:
        type: string
        description: Gender
        example: MALE
        enum:
          - MALE
          - FEMALE
          - UNKNOWN
      nationality:
        type: string
        description: Nationality
        example: United Kingdom
      countryOfResidence:
        type: string
        description: Country of Residence
        example: United Arab Emirates
      emiratesId:
        $ref: '#/definitions/EmiratesId'
      passport:
        $ref: '#/definitions/Passport'
      visa:
        $ref: '#/definitions/Visa'
      contact:
        $ref: '#/definitions/Contact'
      birthDate:
        type: string
        description: Date of Birth
        format: date-time
      imageUrl:
        type: string
        description: Image URL
        example: '/agencies/did:rta:1021252/7c96c336f65e2.png'
      attachments:
        type: array
        description: Attachments
        items:
          $ref: '#/definitions/Attachment'
      driverLicense:
        $ref: '#/definitions/DriverLicense'
    description: Drivers
  DriverLicense:
    type: object
    properties:
      id:
        type: string
        description: Driving License ID
        example: '78419771212212'
      categories:
        type: array
        description: Driving License Category
        items:
          type: string
          description: Driving License Category
          example: Light Vehicles
      issueDate:
        type: string
        description: Driving License Issued Date
        example: '2020-09-01'
      expiryDate:
        type: string
        description: Driving License Expiry Date
        example: '2021-08-31'
      issuedBy:
        type: string
        description: Driving License Issued By
        example: Dubai
      issuingAuthority:
        type: string
        description: Driving License Issuing Authority
        example: UAE
      issuingCountry:
        type: string
        description: Driving License Issuing Country
        example: UAE
    description: Driver License
  VehicleReading:
    type: object
    properties:
      readAt:
        type: string
        description: Read Timestamp
        format: date-time
        example: '2020-07-01T16:20:04Z'
      fuelLevel:
        $ref: '#/definitions/Reading'
      odometer:
        $ref: '#/definitions/Reading'
    description: Vehicle Reading
  Plate:
    type: object
    properties:
      category:
        $ref: '#/definitions/MultiLang'
      source:
        $ref: '#/definitions/MultiLang'
      code:
        $ref: '#/definitions/MultiLang'
      number:
        type: string
        description: Plate Number
      status:
        type: string
        description: Plate Status
    description: Plate
  PersonNameMultiLang:
    type: object
    properties:
      ar:
        $ref: '#/definitions/PersonName'
      en:
        $ref: '#/definitions/PersonName'
    description: First Name in Arabic and English
  PersonName:
    type: object
    properties:
      title:
        type: string
        description: Title
        example: Mr.
      firstName:
        type: string
        description: First Name
        example: John
      middleName:
        type: string
        description: Middle Name
        example: B
      lastName:
        type: string
        description: Last Name
        example: Doe
      suffix:
        type: string
        description: Suffix
        example: Jr.
    description: Person Name in English
  Visa:
    type: object
    properties:
      visaType:
        type: string
        description: Visa Type
        example: RESIDENCE
      file:
        type: string
        description: Visa File Number
        example: 302/2018/1234567
      uid:
        type: string
        description: Visa UID Number
        example: '784197054649928'
      issuedPlace:
        type: string
        description: Visa Issued Place
        example: Dubai
      issuedDate:
        type: string
        description: Visa Issued Date
        format: date-time
      expiryDate:
        type: string
        description: Visa Expiry Date
        format: date-time
      sponsor:
        $ref: '#/definitions/MultiLang'
      status:
        type: string
        description: Visa Status
        example: ACTIVE
    description: Visa
  Passport:
    type: object
    properties:
      passportType:
        type: string
        description: Passport Type
        example: REGULAR
      passportNumber:
        type: string
        description: Passport Number
        example: '791234567'
      issuedCountry:
        type: string
        description: Passport Issuing Country
        example: United Kingdom
      issuedPlace:
        type: string
        description: Passport Issued Place
        example: London
      issuedDate:
        type: string
        description: Passport Issued Date
        format: date-time
      expiryDate:
        type: string
        description: Passport Expiry Date
        format: date-time
    description: Passport
  EmiratesId:
    type: object
    properties:
      id:
        type: string
        description: Emirates ID
        example: '78419771212212'
      issueDate:
        type: string
        description: Emirates ID Issued Date
        example: '2020-09-01'
      expiryDate:
        type: string
        description: Emirates ID Expiry Date
        example: '2021-08-31'
    description: Emirates ID
  Contact:
    type: object
    properties:
      addresses:
        type: array
        description: Addresses
        items:
          $ref: '#/definitions/Address'
      phones:
        type: array
        description: Phones
        items:
          $ref: '#/definitions/Phone'
      emails:
        type: array
        description: Emails
        items:
          $ref: '#/definitions/Email'
    description: Contacts
  CodeName:
    type: object
    properties:
      code:
        type: string
        description: Code
      name:
        $ref: '#/definitions/MultiLang'
    description: Emirate
  Address:
    type: object
    properties:
      label:
        type: string
        description: Address Label
        example: work
      address:
        $ref: '#/definitions/MultiLang'
      makani:
        type: string
        description: Makani Number
        example: 24330 87031
      poBox:
        type: string
        description: PO Box Number
        example: '9226'
      area:
        $ref: '#/definitions/CodeName'
      subArea:
        $ref: '#/definitions/CodeName'
      community:
        $ref: '#/definitions/CodeName'
      unit:
        $ref: '#/definitions/CodeName'
      building:
        $ref: '#/definitions/CodeName'
      street:
        $ref: '#/definitions/CodeName'
      city:
        $ref: '#/definitions/CodeName'
      region:
        $ref: '#/definitions/CodeName'
      country:
        $ref: '#/definitions/CodeName'
      postalCode:
        type: string
        description: Postal Code
        example: '9226'
      emirate:
        $ref: '#/definitions/CodeName'
      geoLocation:
        $ref: '#/definitions/Geolocation'
      preferred:
        type: boolean
        description: Preferred Address Flag
        example: true
    description: Addresses
  CountryCode:
    type: string
    description: The country code.
    example: 'codes:country:ae'
  EmirateCode:
    type: string
    description: The code of an UAE emirate.
    enum:
      - 'codes:emirate:dubai'
      - 'codes:emirate:abu_dhabi'
      - 'codes:emirate:sharjah'
      - 'codes:emirate:ajman'
      - 'codes:emirate:ras_al_khaimah'
      - 'codes:emirate:fujairah'
      - 'codes:emirate:umm_al_quwain'
  Attachment:
    type: object
    properties:
      label:
        type: string
        description: Attachment Label
        example: passport
      reference:
        type: string
        description: Attachment Reference UID
        example: 'did:in:2232124123'
      url:
        type: string
        description: Attachment URL
        example: /attachments/582342345
      hash:
        type: string
        description: Attachment Hash
        example: 4e76434eea3c9d9cf9cb10bbf3f4a74b
    description: Attachments
  Reading:
    type: object
    properties:
      unit:
        type: string
        description: Reading Unit
        example: km
      value:
        type: integer
        description: Reading value
        format: int32
        example: 1000
    description: Odometer
  Phone:
    type: object
    properties:
      label:
        type: string
        description: Phone Label
        example: work
      countryCode:
        type: string
        description: Country Code
        example: '+971'
      phone:
        type: string
        description: Phone
        example: '43435353'
      extension:
        type: string
        description: Extension
        example: '1234'
      preferred:
        type: boolean
        description: Preferred Phone Flag
        example: true
    description: Phones
  Email:
    type: object
    properties:
      label:
        type: string
        description: Email Label
        example: personal
      email:
        type: string
        description: Email
        example: john.doe@example.com
      preferred:
        type: boolean
        description: Preferred Email Flag
        example: true
    description: Emails
  Geolocation:
    type: object
    properties:
      latitude:
        type: number
        description: Latitude
        format: double
        example: 25.1892807
      longitude:
        type: number
        description: Longitude
        format: double
        example: 55.2561466
    description: Geolocation
  BorrowingReturn:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Contract
        format: int64
        example: 1
      kind:
        type: string
        description: Kind of Contract
        example: BORROWING
      did:
        type: string
        description: Decentralized Identifier for the Agency
        example: 'did:rta:1021252'
      source:
        type: string
        description: Source for the Decentralized ID
        example: tars
      sourceKey:
        type: string
        description: Contract Number from the Source
        example: '1021252'
      rentalCounter:
        type: string
        description: Rental Counter
        example: 'did:ded:37283232'
      documentNumber:
        type: string
        description: Document Number from the Source
        example: '1021252'
      documentDateTime:
        type: string
        description: Contract Date
        format: date-time
      employee:
        $ref: '#/definitions/EmployeeHeader'
      status:
        type: string
        description: Contract Status
        example: ACTIVE
        enum:
          - ACTIVE
          - CANCELED
          - CLOSED
      createdBy:
        type: string
        description: Audit Field - Created By
        example: tars
      updatedBy:
        type: string
        description: Audit Field - Updated By
        example: tars
      createdAt:
        type: string
        description: Audit Field - Created Timestamp
        format: date-time
        example: '2020-06-01T12:30:30Z'
      updatedAt:
        type: string
        description: Audit Field - Updated Timestamp
        format: date-time
        example: '2020-06-01T12:30:30Z'
      details:
        type: array
        description: Details
        items:
          $ref: '#/definitions/ContractReturnDetails'
      charges:
        type: array
        description: Charges
        items:
          $ref: '#/definitions/Charge'
      payments:
        type: array
        description: Payables
        items:
          $ref: '#/definitions/RentalPayables'
  ContractReturnDetails:
    type: object
    properties:
      vehicle:
        $ref: '#/definitions/VehicleHeader'
      returnedDate:
        type: string
        description: Returned Date
        format: date-time
      readings:
        type: array
        description: Vehicle Reading
        items:
          $ref: '#/definitions/VehicleReading'
    description: Return
  Charge:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Charge
        format: int64
        example: 1
      did:
        type: string
        description: Decentralized Identifier for the Charge
        example: 'did:salik:12345'
      source:
        type: string
        description: Source for the Decentralized ID
        example: salik
      sourceKey:
        type: string
        description: Natural Key from the Source
        example: '12345'
      versionHash:
        type: string
        description: Hash of all trackable attributes
        example: 2fdc0177057d3a5c6c2c0821e01f4fa8d90f9a3bb7afd82b0db526af98d68de8
      vehicle:
        $ref: '#/definitions/VehicleHeader'
      plate:
        $ref: '#/definitions/Plate'
      chargedOn:
        type: string
        description: Charge Created Timestamp
        format: date-time
        example: '2020-06-15T12:29:30Z'
      chargeDetails:
        $ref: '#/definitions/ChargeDetails'
      createdBy:
        type: string
        description: Audit Field - Created By
        example: tars
      updatedBy:
        type: string
        description: Audit Field - Updated By
        example: tars
      createdAt:
        type: string
        description: Audit Field - Created Timestamp
        format: date-time
        example: '2020-06-15T12:30:30Z'
      updatedAt:
        type: string
        description: Audit Field - Updated Timestamp
        format: date-time
        example: '2020-06-15T12:30:30Z'
    description: Charges
  RentalPayables:
    type: object
    properties:
      paymentDate:
        type: string
        description: Data of payment due or actual payment
        format: date-time
      kind:
        type: string
        description: Kind of Payable Amount
        example: RENT
      periodicity:
        type: string
        description: Periodicity
        example: DAILY
      value:
        $ref: '#/definitions/Amount'
      references:
        $ref: '#/definitions/References'
  ChargeDetails:
    type: object
    properties:
      tolls:
        type: array
        description: Tolls
        items:
          $ref: '#/definitions/Toll'
      fines:
        type: array
        description: Tolls
        items:
          $ref: '#/definitions/Fine'
      parkings:
        type: array
        description: Tolls
        items:
          $ref: '#/definitions/Parking'
    description: Details
  References:
    type: object
    properties:
      membership:
        type: string
        description: 'References such as Membership, Loyalty and Discounts'
        example: '7634981659272872'
  OrderReferences:
    type: object
    properties:
      order:
        type: string
        description: References such as Order Number
        example: '7634981659272872'
  Fine:
    type: object
    properties:
      issueDate:
        type: string
        description: Issued Date
        format: date-time
      reference:
        type: string
        description: Reference
        example: W249284234
      value:
        $ref: '#/definitions/Amount'
      discount:
        $ref: '#/definitions/Amount'
    description: Tolls
  Parking:
    type: object
    properties:
      issueDate:
        type: string
        description: Issued Date
        format: date-time
      reference:
        type: string
        description: Reference
        example: W249284234
      value:
        $ref: '#/definitions/Amount'
    description: Tolls
  Toll:
    type: object
    properties:
      issueDate:
        type: string
        description: Issued Date
        format: date-time
      reference:
        type: string
        description: Reference
        example: W249284234
      value:
        $ref: '#/definitions/Amount'
    description: Tolls
  Error:
    type: object
    additionalProperties: false
    properties:
      httpCode:
        type: string
        description: Error code
      httpMessage:
        type: string
        description: Error description
      moreInformation:
        type: string
        description: Detailed error description
  BatchResponse:
    type: object
    description: BatchResponse object to give status of contract creation or update.
    properties:
      id:
        type: number
        description: The id of the job
      startDatetime:
        type: string
        format: date-time
        description: The UTC datetime when the job was started.
      endDatetime:
        type: string
        format: date-time
        description: The UTC datetime when the job ended.
      status:
        type: string
        enum:
          - STARTED
          - COMPLETED
        description: The current status of the job.
      exitCode:
        type: string
        description: This tells how the job stopped.
      exitMessage:
        type: string
        description: >-
          Any details related to how the job exited.  In case of failure this
          will include the error details.
      lastUpdated:
        type: string
        format: date-time
        description: The UTC datetime when the job last updated.
      uid:
        type: string
        description: A unique string value that identifies the resource.
    example:
      id: 1
      startDatetime: '2020-07-13T15:32:28Z'
      endDatetime: '2020-07-13T16:00:00Z'
      status: COMPLETED
      exitCode: SUCCESS
      exitMessage: Successfully created contract.
      lastUpdated: '2020-07-13T16:00:00Z'
      uid: 'tars:rta:2020:avis:1213'
  Borrowings:
    type: object
    properties:
      kind:
        type: string
        description: Kind of contract
        example: NRV
      documentNumber:
        type: string
        description: Decentralized Identifier for the Agency
        example: '1234'
      documentDateTime:
        $ref: '#/definitions/Date'
        description: contract date
      borrower:
        $ref: '#/definitions/Borrower'
      details:
        $ref: '#/definitions/ContractDetails'
      references:
        $ref: '#/definitions/ContractReferences'
  Borrower:
    type: object
    properties:
      did:
        type: string
      source:
        type: string
      sourceKey:
        type: string
      versionHash:
        type: string
      name:
        $ref: '#/definitions/EnAr'
  ContractReferences:
    type: object
    additionalProperties: true
    description: 'References such as Membership, Loyalty and Discounts'
    example:
      membership: 7634981659272872
  BorrowingReturnsRequestBody:
    type: object
    properties:
      kind:
        type: string
        description: Kind of contract
        example: NRV
      documentNumber:
        type: string
        description: Decentralized Identifier for the Agency
        example: '1234'
      documentDateTime:
        $ref: '#/definitions/Date'
        description: contract date
      details:
        type: array
        items:
          $ref: '#/definitions/Returns'
      payments:
        $ref: '#/definitions/Payables'
      charges:
        $ref: '#/definitions/Charges'
  Returns:
    type: object
    properties:
      returnedDate:
        type: string
        format: date-time
      readings:
        $ref: '#/definitions/Readings'
      did:
        type: string
        description: Decentralized identifier for the vehicle
      source:
        type: string
      sourceKey:
        type: string
      versionHash:
        type: string
      vin:
        type: string
      plate:
        $ref: '#/definitions/Plate'
  Vehicle:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Vehicle
        format: int64
        example: 1
      did:
        type: string
        description: Decentralized Identifier for the Vehicle
        example: 'did:rta:1GNCS18Z3M0115561'
      source:
        type: string
        description: Source for the Decentralized ID
        example: rta
      sourceKey:
        type: string
        description: Natural Key from the Source
        example: 1GNCS18Z3M0115561
      versionHash:
        type: string
        description: Hash of all trackable attributes
        example: 2fdc0177057d3a5c6c2c0821e01f4fa8d90f9a3bb7afd82b0db526af98d68de8
      owner:
        $ref: '#/definitions/AgencyHeader'
      agency:
        $ref: '#/definitions/AgencyHeader'
      vin:
        type: string
        description: Vehicle Identification Number
        example: 1GNCS18Z3M0115561
      plate:
        $ref: '#/definitions/Plate'
      vehicleMake:
        $ref: '#/definitions/CodeName'
      vehicleModel:
        $ref: '#/definitions/CodeName'
      modelYear:
        type: integer
        description: Vehicle Model Year
        format: int64
        example: 2018
      color:
        $ref: '#/definitions/CodeName'
      capacity:
        type: integer
        description: Vehicle Capacity
        format: int64
        example: 5
      vehicleClass:
        $ref: '#/definitions/MultiLang'
      imageUrl:
        type: string
        description: Image URL
      details:
        $ref: '#/definitions/VehicleDetails'
      isPosted:
        type: boolean
        description: Posted to Blockchain
      status:
        type: string
        description: Status
        example: ACTIVE
        enum:
          - ACTIVE
          - INACTIVE
          - ARCHIVED
      createdBy:
        type: string
        description: Audit Field - Created By
        example: tars
      updatedBy:
        type: string
        description: Audit Field - Updated By
        example: tars
      createdAt:
        type: string
        description: Audit Field - Created Timestamp
        format: date-time
        example: '2020-04-04T16:04:04Z'
      updatedAt:
        type: string
        description: Audit Field - Updated Timestamp
        format: date-time
        example: '2020-04-04T16:04:04Z'
      vehicleCategory:
        $ref: '#/definitions/VehicleCategoryHeader'
  VehicleDetails:
    type: object
    properties:
      fuelType:
        $ref: '#/definitions/CodeName'
      countryOfOrigin:
        $ref: '#/definitions/CodeName'
      numberOfDoors:
        type: integer
        description: Number of Doors
        format: int64
        example: 5
      chassisNumber:
        type: string
        description: Chassis Number
        example: SV30-0169266
      engineNumber:
        type: string
        description: Engine Number
        example: 52WVC10388
      engineCapacity:
        type: integer
        description: Engine Capacity in CC
        format: int64
        example: 2694
      isDueForTest:
        type: boolean
        description: Due for Test
      registration:
        $ref: '#/definitions/VehicleRegistration'
      insurance:
        $ref: '#/definitions/VehicleInsurance'
      features:
        type: array
        description: Features
        items:
          $ref: '#/definitions/CodeName'
      rates:
        $ref: '#/definitions/Rate'
    description: Vehicle Details
  VehicleCategoryHeader:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Vehicle Category
        format: int64
        example: 1
      did:
        type: string
        description: Decentralized Identifier for the Vehicle Category
        example: 'did:agency:1234'
      name:
        $ref: '#/definitions/MultiLang'
  VehicleInsurance:
    type: object
    properties:
      company:
        $ref: '#/definitions/CodeName'
      policyType:
        $ref: '#/definitions/CodeName'
      policyNumber:
        type: string
        description: Policy Number
        example: 2020/0928291/2921/1
      startDate:
        type: string
        description: Policy Start Date
        format: date-time
      expiryDate:
        type: string
        description: Policy Expiry Date
        format: date-time
    description: Insurance
  Rate:
    type: object
    properties:
      oneTimeRate:
        $ref: '#/definitions/Amount'
      dailyRate:
        $ref: '#/definitions/Amount'
      weeklyRate:
        $ref: '#/definitions/Amount'
      monthlyRate:
        $ref: '#/definitions/Amount'
      yearlyRate:
        $ref: '#/definitions/Amount'
    description: Default Rates for vehicles in the category
  VehicleRegistration:
    type: object
    properties:
      number:
        type: string
        description: Registration Number
        example: '12450556'
      issuedDate:
        type: string
        description: Registration Date
        format: date-time
      expiryDate:
        type: string
        description: Registration Expiry Date
        format: date-time
      place:
        type: string
        description: Registration Place
        example: DUBAI
    description: Registration
  Payables:
    type: array
    items:
      type: object
      properties:
        kind:
          type: string
          example: RENT
        paymentDate:
          $ref: '#/definitions/Date'
        periodicity:
          type: string
          example: DAILY
        references:
          $ref: '#/definitions/ContractReferences'
        value:
          $ref: '#/definitions/Amount'
  EnAr:
    type: object
    description: >-
      This object used to capture english and arabic text for any properties. 
      Either en, ar, or both need to be provided.
    properties:
      en:
        type: string
        description: The text in english.
      ar:
        type: string
        description: The text in arabic.
  Charges:
    type: array
    items:
      type: object
      properties:
        did:
          type: string
          description: Decentralized identifier
          example: 'did:salik:12345'
        source:
          type: string
          example: salik
        sourceKey:
          type: string
          example: '12345'
        versionHash:
          type: string
          example: 2fdc0177057d3a5c6c2c0821e01f4fa8d90f9a3bb7afd82b0db526af98d68de8
        vehicle:
          $ref: '#/definitions/Vehicle'
        plate:
          $ref: '#/definitions/Plate'
        chargedOn:
          type: string
          format: date-time
        chargeDetails:
          type: object
          properties:
            tolls:
              type: array
              items:
                $ref: '#/definitions/BasicCharge'
            fines:
              type: array
              items:
                type: object
                properties:
                  discount:
                    $ref: '#/definitions/Money'
                  issueDate:
                    type: string
                    format: date-time
                  reference:
                    type: string
                    example: W249284234
                  value:
                    $ref: '#/definitions/Money'
            parkings:
              type: array
              items:
                $ref: '#/definitions/BasicCharge'
        createdBy:
          type: string
          example: tars
        updatedBy:
          type: string
          example: tars
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
  BasicCharge:
    type: object
    properties:
      issueDate:
        type: string
        format: date-time
      reference:
        type: string
        example: W249284234
      value:
        $ref: '#/definitions/Money'
  Money:
    type: object
    properties:
      currencyCode:
        type: string
        description: The currency code used conforming to ISO 4217.
        default: AED
      amount:
        type: number
        description: A positive number.
        default: 0
  Readings:
    type: array
    items:
      type: object
      properties:
        fuelLevel:
          $ref: '#/definitions/Reading'
        odometer:
          $ref: '#/definitions/Reading'
        readAt:
          $ref: '#/definitions/Date'
  ProblemJson:
    type: object
    properties:
      detail:
        type: string
      type:
        type: string
        default: 'about:blank'
      title:
        type: string
      status:
        type: number
      instance:
        type: string
  CreatedUpdated:
    type: object
    properties:
      createdBy:
        type: string
      updatedBy:
        type: string
      createdAt:
        $ref: '#/definitions/Date'
      updatedAt:
        $ref: '#/definitions/Date'
  EmployeeHeader:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Employee
        format: int64
        example: 1
      did:
        type: string
        description: Decentralized Identifier for the Employee
        example: 'did:eid:784199952698752'
      employeeNumber:
        type: string
        description: Employee Number
        example: '11313'
      firstName:
        $ref: '#/definitions/MultiLang'
      familyName:
        $ref: '#/definitions/MultiLang'
      role:
        type: string
        description: Role
        example: Manager
      userId:
        type: string
        description: Portal User ID
        example: john.doe@example.com
    description: Employee
  Borrowing:
    type: object
    properties:
      id:
        type: integer
        description: Unique Identifier for the Contract
        format: int64
        example: 1
      kind:
        type: string
        description: Kind of Contract
        example: BORROWING
      did:
        type: string
        description: Decentralized Identifier for the Agency
        example: 'did:rta:1021252'
      source:
        type: string
        description: Source for the Decentralized ID
        example: tars
      sourceKey:
        type: string
        description: Contract Number from the Source
        example: '1021252'
      rentalCounter:
        type: string
        description: Rental Counter
        example: 'did:ded:37283232'
      documentNumber:
        type: string
        description: Document Number from the Source
        example: '1021252'
      documentDateTime:
        type: string
        description: Contract Date
        format: date-time
      employee:
        $ref: '#/definitions/EmployeeHeader'
      status:
        type: string
        description: Contract Status
        example: ACTIVE
        enum:
          - ACTIVE
          - CANCELED
          - CLOSED
      createdBy:
        type: string
        description: Audit Field - Created By
        example: tars
      updatedBy:
        type: string
        description: Audit Field - Updated By
        example: tars
      createdAt:
        type: string
        description: Audit Field - Created Timestamp
        format: date-time
        example: '2020-06-01T12:30:30Z'
      updatedAt:
        type: string
        description: Audit Field - Updated Timestamp
        format: date-time
        example: '2020-06-01T12:30:30Z'
      borrower:
        $ref: '#/definitions/AgencyHeader'
      requester:
        type: string
        description: Requester
        example: Bob D
      details:
        type: array
        description: Details
        items:
          $ref: '#/definitions/ContractDetails'
      references:
        $ref: '#/definitions/OrderReferences'
  RentalAgencyTransaction:
    type: object
    properties:
      remarks:
        type: string
      createdBy:
        type: string
      createdAt:
        $ref: '#/definitions/Date'
      details:
        type: string
      kind:
        type: string
        enum:
          - REGULATORY_SUPERVISOR_APPROVE
          - REGULATORY_SUPERVISOR_REVIEW_REQUEST
          - ENFORCEMENT_APPROVER_APPROVE
          - ENFORCEMENT_APPROVER_REQUEST_FOR_MEETING
          - ENFORCEMENT_APPROVER_REJECT
          - SYSTEM_ADMIN_APPROVE
  RecordRentalAgency:
    type: object
    description: The RecordRentalAgency object to either create or update a rental agency.
    properties:
      did:
        type: string
        description: id of the agency
      versionHash:
        type: string
        description: The SHA256 hash calculated for the rental agency.
      name:
        $ref: '#/definitions/EnAr'
      chainName:
        $ref: '#/definitions/EnAr'
      trafficFileNumber:
        type: string
        description: The traffic file number of the rental agency.
      isActive:
        type: boolean
        default: false
      isArchived:
        type: boolean
        default: false
      parent:
        type: object
        properties:
          name:
            $ref: '#/definitions/EnAr'
      tradeLicense:
        type: object
        properties:
          licenseNo:
            type: string
          issuedDate:
            type: string
          expiryDate:
            type: string
  BorrowingReplacements:
    type: object
    properties:
      kind:
        type: string
        description: Kind of contract
        example: NRV
      documentNumber:
        type: string
        description: Decentralized Identifier for the Agency
        example: '1234'
      documentDateTime:
        $ref: '#/definitions/Date'
        description: contract date
      borrower:
        $ref: '#/definitions/Borrower'
      details:
        $ref: '#/definitions/ContractDetails'
      references:
        $ref: '#/definitions/ContractReferences'
      charges:
        $ref: '#/definitions/Charges'
      returns:
        type: array
        items:
          $ref: '#/definitions/Returns'
      payments:
        $ref: '#/definitions/Payables'
  ContractUpdate:
    type: object
    properties:
      contractDetails:
        $ref: '#/definitions/Contract'
      verificationInfo:
        $ref: '#/definitions/VerifiedRequest'
  CreateBulkResponse:
    type: object
    additionalProperties: false
    properties:
      id:
        type: string
        description: Bulk Batch ID
        example: '3'
  VerifiedRequest:
    type: object
    properties:
      hashOfRequestBody:
        type: string
      digitalSignature:
        type: string
  SecurityHeld:
    type: object
    properties:
      asOfDate:
        $ref: '#/definitions/Date'
      heldAmount:
        $ref: '#/definitions/Money'
  ContractCreation:
    type: object
    properties:
      contractType:
        type: string
        enum:
          - B2C
          - NRV
          - BORROWING
          - MAINTENANCE
        description: The type of the contract
      contractInformation:
        type: object
        properties:
          linkedContracts:
            type: array
            items:
              type: object
              properties:
                linkType:
                  type: string
                reason:
                  type: string
                contractId:
                  type: string
          isCustodianShipOfVehicleChangedOnReturn:
            type: boolean
            default: false
            description: >-
              Set to true if custodian of vehicle changes when contract is
              closed.
          vehicleControllerEntity:
            type: object
            properties:
              uid:
                type: string
              versionHash:
                type: string
          customerInformation:
            type: object
            properties:
              customerId:
                type: string
              versionHash:
                type: string
              securityHeld:
                $ref: '#/definitions/SecurityHeld'
          reservationNumber:
            type: string
          agreementNumber:
            type: number
          agreementNumberInformation:
            type: object
            properties:
              isTarsCreated:
                type: boolean
              agreementCreatedDatetime:
                $ref: '#/definitions/Date'
          pickupInformation:
            type: object
            properties:
              pickUpDatetime:
                $ref: '#/definitions/Date'
              location:
                $ref: '#/definitions/Address'
          expectedReturnDatetime:
            $ref: '#/definitions/Date'
          returnInformation:
            type: object
            properties:
              returnDatetime:
                $ref: '#/definitions/Date'
              location:
                $ref: '#/definitions/Address'
          constraints:
            type: array
            items:
              type: object
              properties:
                type:
                  type: string
                value:
                  type: string
                valueType:
                  type: string
          vehicleId:
            type: string
          vehicleRentalInformation:
            type: object
            properties:
              odometerReadingOut:
                $ref: '#/definitions/MeasurementUnit'
              fuelOut:
                $ref: '#/definitions/MeasurementUnit'
          drivers:
            type: array
            items:
              type: object
              properties:
                isCustomer:
                  type: boolean
                driverUid:
                  type: string
                versionHash:
                  type: string
            minItems: 1
          depositReceived:
            $ref: '#/definitions/Money'
          charges:
            type: array
            items:
              type: object
              properties:
                class:
                  type: string
                reference:
                  type: string
                rate:
                  $ref: '#/definitions/Money'
                chargeType:
                  type: string
                discountAmount:
                  $ref: '#/definitions/Money'
            minItems: 1
          payments:
            type: array
            items:
              type: object
              properties:
                type:
                  type: string
                currencyCode:
                  type: string
                  example: AED
                amount:
                  type: string
                  example: '100.75'
          termsAndConditionsHash:
            type: string
          termsAndConditionsUrl:
            type: string
  MeasurementUnit:
    type: object
    description: The MeasurementUnit object.
    properties:
      measurementUnit:
        type: string
        description: The unit of measurement used to measure this field. E.g. km
      value:
        type: string
        description: The value of the measurement. e.g. 100
      valueType:
        type: string
        description: 'The value type e.g. string, number, boolean.'
    example:
      measurementUnit: km
      value: '100'
      valueType: number
  Contract:
    $ref: '#/definitions/ContractCreation'
    type: object
    properties:
      contractId:
        type: string
      payments:
        $ref: '#/definitions/Payments'
      created:
        type: object
        properties:
          employeeId:
            type: string
          at:
            $ref: '#/definitions/Date'
      updated:
        type: object
        properties:
          employeeId:
            type: string
          at:
            $ref: '#/definitions/Date'
  Date:
    type: string
    description: The ISO 8601 date time.
    format: date-time
  Payments:
    type: array
    items:
      type: object
      properties:
        paymentMode:
          type: string
        idOfTheTransaction:
          type: string
  Drivers:
    type: array
    items:
      $ref: '#/definitions/Driver'
    minItems: 1
  BulkStatusResponse:
    type: object
    properties:
      id:
        type: string
        description: Bulk Request ID
        example: '1252'
      method:
        type: string
      service:
        type: string
      createdAt:
        type: string
      lines:
        type: array
        description: Status of Items in the Bulk Request
        items:
          $ref: '#/definitions/BulkItems'
  BulkItems:
    type: object
    properties:
      id:
        type: string
      status:
        type: string
      status_code:
        type: number
      message:
        type: string
      runAt:
        type: string
      doneAt:
        type: string
  BorrowingResponse:
    type: object
    properties:
      did:
        type: integer
        example: 'did:rta:1234'
      documentNumber:
        type: integer
        example: 1234
      status:
        type: integer
        example: 202

